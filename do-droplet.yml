---

# playbook for digital ocean
- hosts: localhost
  connection: local

  tasks:
    - set_fact:
        _bw_cmd: "project_create"
      when: (do_project_id|length == 0)
  
    - name: Include Project Creation
      include_tasks: include_tasks/do_projects.yml
      when: (do_project_id|length == 0)
      
    - set_fact:
        _bw_cmd: "sshkey_create"
      when: (do_public_key|length > 0 and do_sshkey_id|length  == 0)
      
    - name: Include SSH Key Creation
      include_tasks: include_tasks/do_sshkeys.yml
      register: _bw_do_sshkey_result
      when: (do_public_key|length > 0 and do_sshkey_id|length  == 0)      
      
    - set_fact:
        _ssh_key_id: "{{ do_sshkey_id }}"
      when: (do_sshkey_id|length  > 0) 
  
    - name: Include DO droplet creation
      include_tasks: include_tasks/do_droplet_creation.yml
      register: _do_droplet_creation_result
      when: (bw_cmd is defined) and (bw_cmd == "create")
    
    - debug:
        msg: "{{ droplet_id }} {{ ip_address }}"
   